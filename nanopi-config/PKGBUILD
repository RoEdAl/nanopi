pkgname=nanopi-config
pkgver=1
pkgrel=1
pkgdesc='NanoPi-specific configuration files'
arch=('arm')
url='http://nanopi.org'
license=('GPL2')
install=${pkgname}.install
depends=('systemd>=215' 'netctl' 'wpa_supplicant' 'bluez' 'bluez-utils' 'openssh' 'dhcp' 'haveged')
optdepends=('wpa_actiond' 'dialog')
backup=('etc/fstab' 'etc/dhcpd.conf' 'etc/systemd/journald.conf')
source=('gadet-friendlyarm.network'
	'ap6210.tar.gz' 
        'fstab'
        'dhcpd.conf'
        'journald.conf'
        'nice.conf'  )
md5sums=('4ea74fb21b0642242a5d72fad6301f92'
         'fc95963e66974e82b1124abf3f152eb2'
         '8211e401cf6b7df390b39e4bcaf72e2d'
         'd709cb2d401baaadd78d7f4c1e8f6f79'
         '4c04b9fdf35f5ac9acc98293cbb2c479'
         'a77651ad978cbbc98f948ee043615ab6')

package() {
  cd ${srcdir}

  msg2 'ap6210 firmware'
  mkdir -p "${pkgdir}/usr/lib/firmware"
  cp -r --preserve=mode ap6210 "${pkgdir}/usr/lib/firmware"
  
  msg2 'systemd-networkd configuration'
  mkdir -p "${pkgdir}/usr/lib/systemd/network"
  install -m644 gadet-friendlyarm.network  "${pkgdir}/usr/lib/systemd/network/70-gadet-frienlyarm.network"

  msg2 'DHCP configuration'
  mkdir -p "${pkgdir}/etc/systemd"
  install -m644 dhcpd.conf "${pkgdir}/etc"

  msg2 'journalling configuration'
  install -m644 journald.conf "${pkgdir}/etc/systemd"

  msg2 'fstab'
  install -m644 fstab "${pkgdir}/etc"

  msg2 'haveged'
  mkdir -p "${pkgdir}/usr/lib/systemd/system/haveged.service.d"
  install -m644 nice.conf "${pkgdir}/usr/lib/systemd/system/haveged.service.d"
}
